(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,n){e.exports=n(34)},28:function(e,t,n){},29:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(12),r=n.n(c),i=(n(28),n(6)),l=n(7),u=n(10),s=n(8),f=n(11),g=(n(29),n(9)),d=n(2),p=n(3),h=["Drinking","Eating","Walking","Standing","Sitting","Chewing Cud","High Activity Heat","Standing Heat","In Parlor"],m=["100","101","102","103","104","105","106"],b=m.reduce(function(e,t){var n=h.reduce(function(e,t){return Object(p.a)({},e,Object(d.a)({},t,!1))},{});return Object(p.a)({},e,Object(d.a)({},t,n))},{}),v=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={turningOff:new Set},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"toggle",value:function(e,t){var n=this,a="".concat(t,"-").concat(e),o=function(){var o=n.props,c=o.config,r=o.updateConfig;c[t][e]=!c[t][e],r(c);var i=n.state.turningOff;i.delete(a),n.setState({updated:Date.now(),turningOff:i})};o();var c=60+(-3+Math.floor(6*Math.random())),r=c-10;console.log("Turning off ".concat(a," in ").concat(c,"s")),setTimeout(function(){console.log("Turning off ".concat(a," in 10s")),n.setState({turningOff:n.state.turningOff.add(a)})},1e3*r),setTimeout(o,1e3*c)}},{key:"render",value:function(){var e=this,t=this.props.config,n=this.state.turningOff;return o.a.createElement("div",{className:"config"},o.a.createElement("table",null,o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{rowSpan:2},"Activity"),o.a.createElement("th",{colSpan:m.length},"Tag ID")),o.a.createElement("tr",null,m.map(function(e){return o.a.createElement("th",{key:e},e)}))),o.a.createElement("tbody",null,h.map(function(a){return o.a.createElement("tr",{key:a},o.a.createElement("th",{className:"row"},a),m.map(function(c){return o.a.createElement("td",{key:c,id:"".concat(c,"-").concat(a),className:"table-option",style:{backgroundColor:n.has("".concat(c,"-").concat(a))?"red":void 0}},o.a.createElement("input",{type:"checkbox",disabled:t[c][a],onChange:e.toggle.bind(e,a,c),checked:t[c][a]}))}))}))))}}]),t}(o.a.Component),O=Object(g.b)(function(e){return{config:(e.settings||{}).config}},function(e){return{updateConfig:function(t){return e(function(e){return function(t){t({type:"UPDATE_CONFIG",payload:e})}}(t))}}})(v),y=n(13),j=n(20),E=n(21),w=n.n(E),k=function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={loggedIn:!1,lastUpload:null},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"generateFiles",value:function(e){var t=this;e&&this.setState({loggedIn:!0}),console.log("Access Token in effect, uploading files"),setInterval(function(){var e=t.props,n=e.config,a=e.tagData;(0,e.recordData)(Object.keys(n).reduce(function(e,t){return Object(p.a)({},e,Object(d.a)({},t,[].concat(Object(y.a)(e[t]||[]),Object(y.a)(function(e,t){var n=h.reduce(function(t,n){return[].concat(Object(y.a)(t),[e[n]?1:0])},[]).join(",");return Array(t).fill(n)}(n[t],4)))))},a))},1e3);!function(e,t){var n,a=new Date,o=e-a%e;console.log("Starting fn in ".concat(o,"ms, with an interval of ").concat(e,"ms")),setTimeout(function(){n=setInterval(t,e),t()},o)}(6e4,function(){var n=t.props,a=n.tagData,o=n.resetData,c=new Date,r=Object.keys(a).reduce(function(e,t){return Object(p.a)({},e,Object(d.a)({},function(e,t){return"T-APP-".concat(e,"-").concat(w.a.format(t,"YYYY-MM-DD-HH-mm-ss"),".txt")}(t,c),a[t].join("\r\n")))},{});Object.keys(r).forEach(function(t){return function(e,t,n){var a=new Blob([t],{type:"text/csv"}),o={name:e,mimeType:"text/csv",parents:["1bRgaE8NhLpcYKb1l8rgxvSmE0nf5oNzL"]},c=new FormData;return c.append("metadata",new Blob([JSON.stringify(o)],{type:"application/json"})),c.append("file",a),fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id",{method:"POST",headers:new Headers({Authorization:"Bearer ".concat(n)}),body:c}).then(function(e){return e.json()}).then(function(e){return console.log(e)})}(t,r[t],e)});var i=Date.now();t.setState({lastUpload:i}),o()})}},{key:"loginResponse",value:function(e){e&&e.accessToken&&this.generateFiles(e.accessToken)}},{key:"render",value:function(){var e=this.state,t=e.loggedIn,n=e.lastUpload,a=n?new Date(n).toLocaleString():null;return o.a.createElement("div",null,t?null:o.a.createElement("div",{style:{position:"fixed",top:10,right:10}},o.a.createElement(j.GoogleLogin,{clientId:"971718329500-246gc90qrsv07kbsc2hhbvq3r738k6sc.apps.googleusercontent.com",buttonText:"Login",onSuccess:this.loginResponse.bind(this),onFailure:this.loginResponse.bind(this),cookiePolicy:"single_host_origin",scope:"https://www.googleapis.com/auth/drive"})),a?o.a.createElement("div",{className:"message"},o.a.createElement("b",null,"Last Upload Time:")," ",o.a.createElement("i",{style:{float:"right"}},a)):null)}}]),t}(o.a.Component),D=Object(g.b)(function(e){return{config:(e.settings||{}).config,tagData:e.data||{}}},function(e){return{recordData:function(t){return e(function(e){return function(t){t({type:"RECORD_DATA",payload:e})}}(t))},resetData:function(){return e(function(e){e({type:"RESET_DATA",payload:[]})})}}})(k),T=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement("h2",null,"T-APP"),o.a.createElement(O,null),o.a.createElement(D,null))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A=n(4),S=n(22),C=Object(A.c)({settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{config:b},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_CONFIG":return{config:t.payload};default:return e}},data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECORD_DATA":return Object(p.a)({},e,t.payload);case"RESET_DATA":return{};default:return e}}});r.a.render(o.a.createElement(g.a,{store:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(A.d)(C,e,Object(A.a)(S.a))}()},o.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[23,1,2]]]);
//# sourceMappingURL=main.69d4950d.chunk.js.map